
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Programming Rambling</title>
  <meta name="author" content="Gonzalo Míguez">

  
  <meta name="description" content="I have recently been wrestling with ElasticSearch/Elastic and how to finally enable mlockall under
CentOS 7. You usually will get the &#8220;Unable &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mrzard.github.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Programming Rambling" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Programming Rambling</a></h1>
  
    <h2>mrzard's ramblings in the wild</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mrzard.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about-me">About me</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/25/elasticsearch-enable-mlockall-in-centos-7/">ElasticSearch: Enable Mlockall in CentOS 7</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-25T14:50:00+01:00" pubdate data-updated="true">Mar 25<span>th</span>, 2015</time>
        
         | <a href="/blog/2015/03/25/elasticsearch-enable-mlockall-in-centos-7/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have recently been wrestling with ElasticSearch/Elastic and how to finally enable mlockall under
CentOS 7. You usually will get the &#8220;Unable to lock JVM memory (ENOMEM). This can result in part of
the JVM being swapped out. Increase RLIMIT_MEMLOCK (ulimit)`.&#8221;</p>

<p>These are all the places I made changes to get it to work. Now, I don&#8217;t know if some of these
steps are skippable (my guess is some of them are), but I got it working i nthe end, and my nodes
are now happily showing `mlockall: true&#8220;</p>

<ul>
<li><p>Make sure <code>bootstrap.mlockall: true</code> is uncommented in <code>/etc/elasticsearch/elasticsearch.yml</code> or
the appropiate config file for your configuration.</p></li>
<li><p>Edit <code>/etc/security/limits.conf</code> and add these lines (or edit them if applicable). You usually
will want to add them at the very end of the file.</p></li>
</ul>


<figure class='code'><figcaption><span>/etc/security/limits.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>elasticsearch <span class="p">-</span> nofile <span class="m">65535</span>
</span><span class='line'>elasticsearch <span class="p">-</span> memlock unlimited
</span><span class='line'>root <span class="p">-</span> memlock unlimited
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Edit <code>/etc/sysconfig/elasticsearch</code>. You will find these values commented, and possibly without
values. Change them to these:</li>
</ul>


<figure class='code'><figcaption><span>/etc/sysconfig/elasticsearch</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'># ES_HEAP_SIZE; <span class="m">30</span>g <span class="k">for</span> my nodes <span class="p">-</span> look <span class="k">up</span> <span class="k">a</span> good value <span class="k">for</span> yours
</span><span class='line'>ES_HEAP_SIZE<span class="p">=</span><span class="m">30</span>g
</span><span class='line'>
</span><span class='line'>MAX_OPEN_FILES<span class="p">=</span><span class="m">65535</span>
</span><span class='line'>MAX_LOCKED_MEMORY<span class="p">=</span>unlimited
</span><span class='line'>...
</span><span class='line'># WORK_DIR: Make sure /tmp <span class="k">is</span> not mounted <span class="k">as</span>
</span><span class='line'># noexec OR <span class="k">put</span> <span class="k">a</span> regular <span class="nb">directory</span> here
</span><span class='line'>WORK_DIR<span class="p">=</span><span class="sr">/tmp/</span>elasticsearch
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Edit <code>/usr/lib/systemd/system/elasticsearch.service</code> and make sure <code>LimitMEMLOCK</code> is uncommented
and set to infinity</li>
</ul>


<figure class='code'><figcaption><span>/usr/lib/systemd/system/elasticsearch.service</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'># See MAX_LOCKED_MEMORY <span class="k">in</span> sysconfig<span class="p">,</span> use <span class="s2">&quot;infinity&quot;</span>
</span><span class='line'># when MAX_LOCKED_MEMORY<span class="p">=</span>unlimited
</span><span class='line'># and using bootstrap.mlockall: true
</span><span class='line'>LimitMEMLOCK<span class="p">=</span>infinity
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Edit <code>/etc/init.d/elasticsearch</code> and add <code>su $ES_USER --shell /bin/bash -c "ulimit -l unlimited"</code>
before the actual start of ES, this is more or less how it looks in mine:</li>
</ul>


<figure class='code'><figcaption><span>/etc/init.d/elasticsearch</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>echo <span class="p">-</span><span class="k">n</span> $<span class="s2">&quot;Starting $prog: &quot;</span>
</span><span class='line'># <span class="k">if</span> not running<span class="p">,</span> <span class="k">start</span> it <span class="k">up</span> here<span class="p">,</span> usually something like <span class="s2">&quot;daemon $exec&quot;</span>
</span><span class='line'><span class="nb">su</span> $ES_USER <span class="p">--</span><span class="k">shell</span> <span class="sr">/bin/</span>bash <span class="p">-</span><span class="k">c</span> <span class="s2">&quot;ulimit -l unlimited&quot;</span>
</span><span class='line'>daemon <span class="p">--</span>user $ES_USER <span class="p">--</span>pidfile $pidfile $exec <span class="p">-</span><span class="k">p</span> $pidfile <span class="p">-</span><span class="k">d</span> <span class="p">-</span>Des.default.<span class="nb">path</span>.home<span class="p">=</span>$ES_HOME <span class="p">-</span>Des.default.<span class="nb">path</span>.logs<span class="p">=</span>$LOG_DIR <span class="p">-</span>Des.default.<span class="nb">path</span>.data<span class="p">=</span>$DATA_DIR <span class="p">-</span>Des.default.<span class="nb">path</span>.work<span class="p">=</span>$WORK_DIR <span class="p">-</span>Des.default.<span class="nb">path</span>.<span class="k">conf</span><span class="p">=</span>$CONF_DIR
</span></code></pre></td></tr></table></div></figure>


<p>After I had everything in place, I restared my nodes and now they all show <code>mlockall: true</code> when
checked with <code>curl http://localhost:9200/_nodes/process?pretty</code></p>

<p>Hope this helps someone!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/30/farewell-2014-welcome-2015/">Farewell 2014, Welcome 2015</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-30T09:00:00+01:00" pubdate data-updated="true">Dec 30<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/12/30/farewell-2014-welcome-2015/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So we are closing another year&#8230; And I see this is just my fourth post of the year. Pretty bad, but at least is a good starting point, because it&#8217;s easy to improve on it.</p>

<p>This will be a long post, so let&#8217;s stop it here, and you can proceed to the full wall of text if you feel like it :)</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/12/30/farewell-2014-welcome-2015/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/20/billy-is-hiring-middleweight-php-developer-needed/">Billy Is Hiring! Middleweight PHP Developer Needed</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-20T10:52:00+02:00" pubdate data-updated="true">Aug 20<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/08/20/billy-is-hiring-middleweight-php-developer-needed/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As most of you know, since June 2nd I&#8217;ve taken the position of MVAS IT Manager at <a href="http://www.billymob.com">Billy Mobile</a>.</p>

<p>Well, the family is growing, and I need a pair of hands on my side.</p>

<p>Right now we are using some Symfony components (HttpFoundation, DependencyInjection, Configuration, Router, EventDispatcher, Console and Templating) and we are creating a lot of libraries for our own use which we control with Composer / Satis. We also are going to possibly include node.js in some of our apps.</p>

<p>Your job will be connecting our apps with 3rd party APIs, creating new libraries that connect us to different services, thinking of how to improve our metrics and having fun while doing so. We have three different areas were you can make impact (mobile web apps, a very custom adserver and a REST-ish API for native mobile apps).</p>

<p>We are looking for:</p>

<ul>
<li><p> A fun person to be around</p></li>
<li><p> All-around nice person</p></li>
<li><p> Middleweight PHP developer. You have some experience, but want to improve and / or take on new challenges. Or maybe you have a ton of experience, and you like this job posting!</p></li>
<li><p> Comfortable with MySQL (queries, indexes, joins&#8230;)</p></li>
<li><p> Comfortable with the Mediator pattern and design patterns in general</p></li>
<li><p> Comfortable with git and composer</p></li>
<li><p> Understands Dependency Injection</p></li>
<li><p> Can document code, or writes code so beautiful it&#8217;s auto-commented (if this is you please teach me).</p></li>
<li><p> Maybe has a bit (or a lot) of experience with testing.</p></li>
<li><p> Maybe has experience with key-value stores (Redis, Memcached or other), and NoSQL solutions (MongoDB, CouchDB, ElasticSearch or other&#8230;)</p></li>
<li><p> <em>Strong english skills required</em> - this a must, as we are an international company that need to communicate clearly in English with both coworkers and partners.</p></li>
</ul>


<p>We are offering:</p>

<ul>
<li><p> Good salary and company perks</p></li>
<li><p> An environment were prototyping, putting your ideas out there and trying new stuff is encouraged</p></li>
<li><p> Lots of growth opportunities</p></li>
<li><p> The chance to impact a working business model</p></li>
<li><p> Working with yours truly which is AWESOME</p></li>
<li><p> Free coffee and soft drinks</p></li>
<li><p> Great coworkers</p></li>
</ul>


<p>Do you think you want this job? Then drop me an email at my name at billymob.com or <a href="https://www.linkedin.com/jobs2/view/11081010?trk=biz-overview-job-post">apply on LinkedIn</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/06/what-i-have-learnt-as-a-cto/">What I Have Learnt as a CTO</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-06T16:45:00+02:00" pubdate data-updated="true">May 6<span>th</span>, 2014</time>
        
         | <a href="/blog/2014/05/06/what-i-have-learnt-as-a-cto/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When May comes to and end, I will end my one and a half years journey as
a CTO for <a href="http://www.chicplace.com">ChicPlace.com</a>.</p>

<p>The reasons for my depature are diverse, and possibly this is not the
best place to discuss them, but I am very grateful for the opportunity
to grow and learn while developing a project that has the potential to
be something special.</p>

<p>During this time I have gained a lot of experience managing teams, and
learnt a lot about myself, specially when it comes to working with
non-technical people, and how to manage expectations, deadlines and
organisation when working in a very fast-paced and very improvisational
startup.</p>

<p>I will write a list of things that I have learnt, in the form of:</p>

<ul>
<li>List item.

<ul>
<li>How it has affected me personally.</li>
</ul>
</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/05/06/what-i-have-learnt-as-a-cto/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/30/customize-form-prototype-for-collections-in-symfony2/">Customize Form Prototype for Collections in Symfony2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-30T15:45:00+01:00" pubdate data-updated="true">Oct 30<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/10/30/customize-form-prototype-for-collections-in-symfony2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When working with complex forms, sometimes you will be in need of
creating a collection field type to manage relations. When this is the
case, you may find yourself in the need of tweaking how the ‘add’ form
shows.</p>

<p>It’s pretty simple. In twig the protoype can be found under
form.collection.vars.prototype and can be used as a regular form (i.e.
if your form.collection member form has a ‘name’, it will also be
available in form.collection.vars.protoype.name).</p>

<p>With this information now you can create a twig that recieves an ‘item’,
which can be either a form.collection member or a prototype, and it will
be rendered the same.</p>

<p>Finally, wherever you hold the collection html, you will have to output
something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>data-prototype="{% filter escape %}{% include 'prototype.twig' with { 'item': form.collection.vars.prototype } %}{% endfilter %}"</span></code></pre></td></tr></table></div></figure>


<p>And your <code>prototype.twig</code> should look like</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{{ form_row(item.field0) }}
</span><span class='line'>  {{ form_row(item.field1) }}
</span><span class='line'>  {{ form_row(item.field2) }}</span></code></pre></td></tr></table></div></figure>


<p>This way, you will have access to the prototype as if it were a regular
form, and you can apply all the customization you want (you can user
form_widget and the other functions, or access the vars directly, etc&#8230;)</p>

<p>Creating the helper twig is optional though, but handy because you have
to use the escape filter to the twig so you can put it in the correct
data-attribute.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/10/flushing-only-desired-entities-with-doctrine/">Fluhsing Only Desired Entities With Doctrine</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-10T16:45:00+02:00" pubdate data-updated="true">Oct 10<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/10/10/flushing-only-desired-entities-with-doctrine/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sometimes, you may be working with several entities at the same time. If
this entities are managed by Doctrine, you may find yourself in the
situation where you want to flush only some of them. If you want to do
so, you can pass an array of entities to the flush(), so it only affects
the entities you explicitly pass to the function.</p>

<p>This is very useful to avoid side-effects in some instances.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/28/loading-cross-domain-fonts-from-firefox/">Loading Cross-domain Fonts From Firefox</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-28T15:45:00+01:00" pubdate data-updated="true">Mar 28<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/28/loading-cross-domain-fonts-from-firefox/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When requiring a font from an external CSS file (assets domain, CDN,
etc), you may see that Firefox refuses to display the font. This is
because Firefox, by default, disables cross-domain fonts. To solve this
you have to add a header to the response with the font file. The header
is <code>Access-Control-Allow-Origin: *</code></p>

<p>In a typical <code>nginx</code> setup, this is achieved with this snippet:</p>

<p>nginx add header</p>

<figure class='code'><figcaption><span>nginx add header</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>location ~* \.(eot|ttf|woff)$ {
</span><span class='line'>  add_header Access-Control-Allow-Origin *;
</span><span class='line'>}   </span></code></pre></td></tr></table></div></figure>


<p>Once you have that in place, the fonts will be loaded correctly from
Firefox.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/26/my-experience-with-paymill/">My Experience With Paymill</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-26T12:30:00+01:00" pubdate data-updated="true">Mar 26<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/26/my-experience-with-paymill/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been using <a href="https://www.paymill.com">Paymill</a> at work for some time now, and this is what I think of it thus far:</p>

<p>PROS:</p>

<ul>
<li>Easy to implement. As in dumb-proof easy.</li>
<li>Commission (2.95% + 0.28€) is reasonable against time of implementation.</li>
<li>No other fees. No setup fee, no base usage fee, nothing, only their commission.</li>
<li>They only charge for successful transactions.</li>
<li>Pays every 7 days, directly to your bank account.</li>
<li>Removes lots of man-hours in payment-gateway related stuff.</li>
<li>Removes the need to be PCI-compliant.</li>
<li>They have <a href="https://github.com/Paymill">libraries</a> for lots of languages and software packages.</li>
</ul>


<p>CONS:</p>

<ul>
<li>Test mode and live mode do <em>not</em> behave the same in some instances.

<ul>
<li>Have not checked recently, but at a point the test mode worked with a deprecated parameter that resulted in an error if used in live mode.</li>
<li>As of now, the amount sent to the bridge and the backend do NOT have to match in test mode for a successful transaction</li>
</ul>
</li>
<li>Error messages are not that clear, although they have improved in that area.

<ul>
<li><code>40000 RESPONSE_DATA: general problem with data</code> or <code>40100 RESPONSE_DATA_CARD: problem with creditcard data</code> are not very telling. I got a 40100 for a client who did not have 3D-Secure enabled.</li>
</ul>
</li>
<li>Sometimes they take a long time to answer to support tickets.</li>
</ul>


<p>BOTTOMLINE:</p>

<p>Paymill is a great tool and I recommend it if you need a payment gateway FAST and cannot / do not want to spend time going PCI-compliant. Only thing that worries me is the discrepancy in behaviour between test mode and live mode which makes it necessary to run some &#8216;live&#8217; tests that would not be necessary otherwise. Anyway, once you have detected these little things you can work around them with your own tests and assertions.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/25/mrzard-now-octopress-github-pages/">MrZarD, Now on Octopress on GitHub Pages</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-25T15:45:00+01:00" pubdate data-updated="true">Mar 25<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/25/mrzard-now-octopress-github-pages/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Due to <a href="http://www.posterous.com/">Posterous</a> closing soon I had to look for another place to host my (seldomly updated) blog. After 10 minutes, I saw GitHub Pages and then saw <a href="http://octopress.org/">Octopress</a>. The combination of both is awesome and really feels great for a developer instead of a classic web interface.</p>

<p>So, now you can find me here, at GitHub. Same content, same guy, same few updates!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/13/export-prestashop-data-to-a-shopify-csv/">MySQL Query to Export Prestashop Data to a Shopify CSV</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-13T18:19:00+01:00" pubdate data-updated="true">Feb 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/13/export-prestashop-data-to-a-shopify-csv/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you find yourself migrating your shop from Prestashop to Shopify, you can
use this query. It was written for an old version of Prestashop, but you probably
won&#8217;t have much trouble adapting it to newer versions.</p>

<p>Also, take in consideration this query only outputs basic data, no variants,
colors, etc. Also check which values do you need for &#8216;variant requires shipping&#8217;,
ID_LANG, etc.</p>

<pre><code>SELECT pl.link_rewrite as `Handle`, pl.name as `Title`, 
pl.description as `Body (HTML)`, 'VENDORNAME' as `Vendor`, pcl.`name` as `Type`, 
t.`name` as Tags, '' as `Option1 Name`, '' as `Option1 Value`, '' as `Option2 Name`, 
'' as `Option2 Value`, '' as `Option3 Name`, '' as `Option3 Value`, '' as `Variant SKU`, 
p.weight * 1000 as `Variant Grams`, '' as `Variant Inventory Tracker`, p.`quantity` 
as `Variant Inventory Qty`, 'deny' as `Variant Inventory Policy`, 'manual' 
as `Variant Fulfillment Service`, p.price as `Variant Price`, p.price_before 
as `Variant Compare At Price`, 'true' as `Variant Requires Shipping`, 'true' 
as `Variant Taxable`, '' as `Image Src` 
FROM 
    `ps_product` p 
    INNER JOIN `ps_product_lang` pl ON pl.`id_product` = p.`id_product` 
    LEFT JOIN `ps_product_tag` pt ON pt.`id_product` = p.`id_product` 
    LEFT JOIN `ps_tag` t ON t.`id_tag` = pt.`id_tag` 
    INNER JOIN `ps_image` pi ON pi.`id_product` = p.`id_product` 
    INNER JOIN `ps_category_lang` pcl ON pcl.`id_category` = p.`id_category_default` 
WHERE 
    pl.`id_lang` = ID_LANG 
    AND pcl.`id_lang` = ID_LANG 
    AND p.`id_category_default` IN (
        SELECT `id_category` 
        FROM `ps_category` WHERE `active` = 1
    ) 
    AND p.`active` = 1 GROUP BY p.`id_product`; 
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/03/25/elasticsearch-enable-mlockall-in-centos-7/">ElasticSearch: Enable mlockall in CentOS 7</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/30/farewell-2014-welcome-2015/">Farewell 2014, Welcome 2015</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/20/billy-is-hiring-middleweight-php-developer-needed/">Billy is hiring! Middleweight PHP developer needed</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/06/what-i-have-learnt-as-a-cto/">What I Have Learnt as a CTO </a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/30/customize-form-prototype-for-collections-in-symfony2/">Customize Form Prototype for Collections in Symfony2</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/mrzard">@mrzard</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mrzard',
            count: 0,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
<h1>Twitter</h1>
<a class="twitter-timeline" href="https://twitter.com/mrzard_dev" data-widget-id="316573872377970688">@mrzard_dev</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Gonzalo Míguez -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mrzardblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
